<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Tahuti</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1"
    />
    <meta
      name="description"
      content="An Expense Sharing App for Urbit"
    />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="apple-mobile-web-app-title" content="Tahuti" />
    <link
      rel="stylesheet"
      href="/apps/tahuti/static/css/min/style.css"
    />
    <link
      rel="stylesheet"
      href="/apps/tahuti/static/css/min/print.css"
      media="print"
    />
    <link
      rel="apple-touch-icon"
      href="https://console.minio.mutualisten.de/api/v1/buckets/public/objects/download?preview=true&prefix=aWNvbi5wbmc=&version_id=null"
    />
    <script src="/apps/tahuti/assets/htmx.js"></script>
    <script src="/apps/tahuti/assets/json-enc.js"></script>
    <script src="/apps/tahuti/assets/path-deps.js"></script>
    <script src="/apps/tahuti/assets/client-side-templates.js"></script>
    <script src="/apps/tahuti/assets/mustache.js"></script>
  </head>

  <body>
    <header>
      <nav>
        <ul>
          <!-- hrefs is set by request.js -->
          <li>
            <a href="/apps/tahuti/groups">↜ Groups</a>
          </li>
          <li>
            <a id="expenses-href" href="">Expenses</a>
          </li>
          <li>
            <a id="balances-href" href="">Balances</a>
          </li>
          <li>
            <a style="opacity: 0.3">Reimbursments</a>
          </li>
          <li>
            <a id="members-href" href=""><strong>Members</strong></a>
          </li>
          <li>
            <a id="settings-href" href="">Settings</a>
          </li>
        </ul>
      </nav>
    </header>

    <div hx-ext="client-side-templates,path-deps">
      <div
        hx-get="/"
        hx-trigger="load"
        mustache-template="title-template"
      >
        <h2 style="opacity: 0">Loading ...</h2>
      </div>
      <template id="title-template">
        <h2>{{title}}</h2>
      </template>

      <h3>Invite</h3>
      <fieldset>
        <form
          id="put-invitees"
          hx-put="/invitees"
          hx-ext="json-enc"
          hx-swap="none"
          hx-on::after-request="if(event.detail.successful) this.reset()"
        >
          <!-- TODO: add validation for valid @p -->
          <input
            id="invitee"
            type="text"
            name="invitee"
            aria-label="invitee"
            placeholder="~zod"
            required="required"
          />
          <br />
          <button class="button-primary" type="submit">Add ▸</button>
        </form>
      </fieldset>

      <h3>Members</h3>
      <ul
        id="get-register"
        hx-get="/register"
        hx-trigger="load,path-deps"
        path-deps="/apps/tahuti/api/groups/*/invitees"
        mustache-template="register-temp"
      ></ul>
      <template id="register-temp">
        <!-- iterate over array of register list -->
        {{#.}}
        <li>{{.}}</li>
        {{/.}}
      </template>

      <h3>Invitees</h3>
      <ul
        id="get-invitees"
        hx-get="/invitees"
        hx-trigger="load,path-deps"
        path-deps="/apps/tahuti/api/groups/*/invitees"
        mustache-template="invitees-temp"
      ></ul>
      <template id="invitees-temp">
        <!-- iterate over array of invitees list -->
        {{#.}}
        <li>{{.}}</li>
        {{/.}}
      </template>
    </div>
  </body>
  <script src="/apps/tahuti/assets/request.js"></script>
</html>
